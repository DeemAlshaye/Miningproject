---
title: "R Notebook"
output:
html_notebook: default
github_document: default
---

## Goal of collecting this Dataset

Predicting Data Science job salaries using classification.

## The source of the dataset Link to the source Dataset:

<https://www.kaggle.com/datasets/arnabchaki/data-science-salaries-2023?resource=download>

## Informition about the Dataset :

Number of Attributes: 11

Type of Attributes: nominal, ordinal, numeric

Number of objects: 3755

Class name: salary

| Attributes names   | Description                                                                                 | Data type        | Possible values                                                                                |
|------------------|------------------|------------------|------------------|
| work_year          | The year the salary was paid                                                                | ordinal          | Range between 2020-2023                                                                        |
| experience_level   | The experience level in the job during the year                                             | ordinal          | (SE:"Senior",MI:"Mid level",EN:"Entry level,EX:"Executive level")                              |
| employment_type    | The type of employment for the role                                                         | nominal          | (FT:"Full time",PT:"Part time",CT:"Contractual",FL:"Freelancer")                               |
| job_title          | The role worked in during the year                                                          | nominal          | (Data Engineer, Data Scientist,Data Analyst, Machine Learning Engineer, Analytics Engineer...) |
| salary             | The total gross salary amount paid                                                          | numeric interval | Range Between [6000 - 30.4m]                                                                   |
| salary_currency    | The currency of the salary paid as an ISO 4217 currency code                                | nominal          | USD,EUR,GBP,INR,CAD...)                                                                        |
| salaryinusd        | The salary in USD                                                                           | numeric interval | Between[5132-450k]                                                                             |
| employee_residence | Employee's primary country of residence in during the work year as an ISO 3166 country code | nominal          | (US,GB,CA,ES,IN...)                                                                            |
| remote_ratio       | The overall amount of work done remotely                                                    | numeric Ratio    | (0, 50, 100)                                                                                   |
| company_location   | The country of the employer's main office or contracting branch                             | nominal          | (US,GB,CA,ES,IN...)                                                                            |
| company_size       | The median number of people that worked for the company during the year                     | ordinal          | (S,M,L)                                                                                        |

### uploding the data and raw samples

```{r}
ds_salaries= read.csv(url("https://raw.githubusercontent.com/DeemAlshaye/Miningproject/main/dataset/ds_salaries.csv"), header=TRUE)
head(ds_salaries)
tail(ds_salaries)
```

```{r}
dim(ds_salaries)
```

### summray the data

```{r}
summary(ds_salaries)
```

### statical mesurment

```{r}
mean(ds_salaries$salary)
median(ds_salaries$salary)
quantile(ds_salaries$salary)
```

```{r}
mean(ds_salaries$salary_in_usd)
median(ds_salaries$salary_in_usd)
quantile(ds_salaries$salary_in_usd)
```

```{r}
mean(ds_salaries$remote_ratio)
median(ds_salaries$remote_ratio)
quantile(ds_salaries$remote_ratio)
```

```{r}
mean(ds_salaries$work_year)
median(ds_salaries$work_year)
quantile(ds_salaries$work_year)
```

```{r}
var(ds_salaries$salary)
var(ds_salaries$salary_in_usd)
var(ds_salaries$remote_ratio)
var(ds_salaries$work_year)
```

### graphs:

### changing the salary and salary in usd to be in 1000s

```{r}
ds_salaries$salary_1000s <- ds_salaries$salary /1000
head(ds_salaries$salary_1000s)

ds_salaries$salaryusd_1000s <- ds_salaries$salary_in_usd /1000
head(ds_salaries$salaryusd_1000s)
```

#### boxplot:

```{r}
boxplot(ds_salaries$salary_1000s,ylim=c(0,1000),xlab="Salary",ylab="Salary in 1000s")
```

```{r}
boxplot(ds_salaries$salaryusd_1000s,ylim=c(0,1000),xlab="Salary in USD",ylab="Salary in usd 1000s")
```

```{r}
boxplot(ds_salaries$work_year,xlab="Work year",ylab="Frequency")
```

### histogram

```{r}
hist(ds_salaries$salary_1000s,ylim=c(0,100),ylab="Frequency",xlab="salary in 1000s",main = "Salary Frequency")
```

### bar plot

```{r}
library(magrittr)

ds_salaries$remote_ratio %>% table() %>% barplot(xlab="remote ratio", main="barplot of remote ratio")
ds_salaries$work_year %>% table() %>% barplot(xlab="work year", ylab="number of employees", main="barplot of work year")
```

### Scatter plot

```{r}
  with(ds_salaries,plot(ds_salaries$salary_1000s,ds_salaries$salaryusd_1000s,xlab="salary in 1000s",ylab = "salary in usd 1000s",main="Scatter plot with salary and salary in USD") )
```

### pie chart

```{r}
library(dplyr)
ds_salaries2 <- ds_salaries %>% sample_n(50)

tab <- ds_salaries2$company_size%>% table()
precentages <- tab %>% prop.table() %>% round(3)*100
txt <- paste0(names(tab),'\n',precentages,'%')
pie(tab,labels=txt)
```

### we took top five job title

```{r}
  library(ggplot2)
library(tidyverse)
top_5_job_salaries<-ds_salaries%>%
  group_by(job_title)%>%
  summarise(Avg_Sal=mean(salary_1000s))%>%
  arrange(desc(Avg_Sal))%>%
  head()
top_5_job_salaries
```

### Visualisation

```{r}
ggplot(top_5_job_salaries, aes(x=job_title, y=Avg_Sal)) +
  geom_col() +
  labs(title="Top 5 Job Title Salaries", x="Job Title", y="Salary in 1000s") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

```{r}
ggplot(ds_salaries, aes(x=experience_level, y=salaryusd_1000s)) +
  geom_boxplot(fill="pink") +
  labs(title="Distribution of Salary by Experience Level", x="Experience Level", y="Salary in 1000s") +
  theme_minimal()
```

### Average Salaries in each Year

```{r}
  library(dplyr)

yearly_salary_avg<-ds_salaries%>%
  group_by(work_year)%>%
  summarise(avg_salary=mean(salary))
yearly_salary_avg
    
```

## Data cleaning

### categorizeing job title

adding new colum with categorized job title

```{r}
library(tidyverse)
categorize_job_title <- function(title) {
  title <- tolower(title)
  if (grepl("data scientist|research scientist|researcher|scientist|science", title)) {
    return("Data Scientist")
  } else if (grepl("data engineer|etl|machine learning software engineer|ai|data architect|engineer|data modeler|machine learning engineer|devops", title)) {
    return("Data Engineer")
  } else if (grepl("data analyst|bi|analyst|head of data|data lead|data strategist|data analytics|specialist|data manager", title)) {
    return("Data Analyst")
  } else {
    return("Other")
  }
}
ds_salaries <- ds_salaries %>% 
  mutate(categorized_job_title = sapply(job_title, categorize_job_title))
head(ds_salaries)
```

we categorized the job title into four categorize ("Data Scientist","Data Engineer","Data Analyst",Other)

### finding missing data

```{r}
sum(is.na(ds_salaries))
```

we have no missing data

### finding outliers:

```{r}
boxplot.stats(ds_salaries$salary)$out
boxplot.stats(ds_salaries$salary_in_usd)$out              
boxplot.stats(ds_salaries$remote_ratio)$out
boxplot.stats(ds_salaries$work_year)$out
```

### sum outliers:

```{r}
sum(boxplot.stats(ds_salaries$salary)$out)

sum(boxplot.stats(ds_salaries$salary_in_usd)$out)

sum(boxplot.stats(ds_salaries$remote_ratio)$out)

sum(boxplot.stats(ds_salaries$work_year)$out)
```

### removing the outliers:

```{r}
library(outliers)
outliers <- boxplot(ds_salaries$salary, plot=FALSE)$out
ds_salaries <- ds_salaries[-which(ds_salaries$salary%in% outliers),]
boxplot.stats(ds_salaries$salary)$out

outliers <- boxplot(ds_salaries$salary, plot=FALSE)$out
ds_salaries <- ds_salaries[-which(ds_salaries$salary%in% outliers),]
boxplot.stats(ds_salaries$salary)$out

outliers <- boxplot(ds_salaries$salary_in_usd, plot=FALSE)$out
ds_salaries <- ds_salaries[-which(ds_salaries$salary_in_usd%in% outliers),]
boxplot.stats(ds_salaries$salary_in_usd)$out

outliers <- boxplot(ds_salaries$work_year, plot=FALSE)$out
ds_salaries <- ds_salaries[-which(ds_salaries$work_year%in% outliers),]
boxplot.stats(ds_salaries$work_year)$out
```

## Data transformation

### Normalization

```{r}
normalize <- function(x) {return((x-min(x))/(max(x)-min(x)))}
ds_salaries$salary<-normalize(ds_salaries$salary)
ds_salaries$salary_in_usd<-normalize(ds_salaries$salary_in_usd)

num1_cols=ds_salaries[, c(5,7 )]
head(num1_cols)
```

we normalized the attributes salary, salary in usd, so it takes values between 0 and 1 ,which helps in handling the data

### Discretization

```{r}
breaks <- quantile(ds_salaries$salary_in_usd, 
                   probs = c(0, 1/7, 2/7, 3/7, 4/7, 5/7,6/7,1), 
                   na.rm = TRUE)

ds_salaries$salary_in_usd_disc <- cut(ds_salaries$salary_in_usd, 
                             breaks = breaks, 
                             include.lowest = TRUE, 
                             labels=c("low", "Low-mid", "mid", "mid-high", "high","very-high","top"))
head(ds_salaries$salary_in_usd_disc)
```

### Encoding

```{r}
ds_salaries$company_size = factor(ds_salaries$company_size,levels = c("S","M","L"),labels = c(1,2,3))
ds_salaries$experience_level = factor(ds_salaries$experience_level,levels = c("EN","MI","SE","EX"),labels = c(1,2,3,4))

ds_salaries$job_title  <- factor(ds_salaries$job_title)
ds_salaries$employment_type  <- factor(ds_salaries$employment_type)
ds_salaries$employee_residence  <- factor(ds_salaries$employee_residence)
ds_salaries$company_location  <- factor(ds_salaries$company_location)
ds_salaries$salary_currency  <- factor(ds_salaries$salary_currency)
ds_salaries$job_title  <- factor(ds_salaries$job_title)
ds_salaries$job_title  <- factor(ds_salaries$job_title)

num_cols=ds_salaries[, c(2,11 )]
head(num_cols)

```

## Feature Selection

```{r}
data <- ds_salaries %>% sample_n(50)
cor(data$salary,data$salary_in_usd)
```

we see that salary and salary_in_usd are highly correlated so we will only take the salary

```{r}
chisq.test(ds_salaries$employee_residence,ds_salaries$company_location,correct = FALSE)
```

we reject the null hypothesis, x-squared\>\>\> p -value they are strongly correlated so we will only take company_location

```{r}
library(tidyverse)
my_data <- ds_salaries %>%
  select(work_year,salary,experience_level,employment_type,job_title,salary_currency,company_location,company_size,remote_ratio)
  head(my_data)
```

### 
